<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cyber Tools</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; margin:0; padding:0; }
    header { background:#111; color:#fff; padding:1rem; text-align:center; }
    main { max-width:800px; margin:2rem auto; background:#fff; padding:2rem; border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,0.2); }
    label { display:block; margin:1rem 0 .3rem; font-weight:bold; }
    input, select, button, textarea { padding:.5rem; font-size:1rem; width:100%; margin-bottom:1rem; }
    .hidden { display:none; }
    .strength { height:10px; background:#ddd; border-radius:5px; margin:.5rem 0; }
    .strength-bar { height:10px; border-radius:5px; width:0; transition:width .3s; }
    footer { text-align:center; margin:2rem 0; font-size:.9rem; color:#777; }
    .result { background:#fafafa; border:1px solid #ccc; padding:1rem; border-radius:8px; }
</style>

</head>
<body>
  <header><h1>üõ°Ô∏è Cyber Tools</h1></header>
  <main>
    <label for="toolSelect">Choose a Tool:</label>
    <select id="toolSelect">
      <option value="hash">Hash Detector</option>
      <option value="password">Password Generator</option>
      <option value="subdomains">Subdomain Finder</option>
    </select>

    <!-- Hash Detector -->
    <div id="hash" class="tool">
      <label for="hashInput">Enter hash value:</label>
      <input id="hashInput" type="text" placeholder="Paste hash here...">
      <button id="detectHash">Detect Hash</button>
      <div id="hashResult" class="result"></div>
    </div>

    <!-- Password Generator -->
    <div id="password" class="tool hidden">
      <label>Password Length: <span id="lenDisplay">12</span></label>
      <input id="passLen" type="range" min="6" max="32" value="12">
      <label><input id="incUpper" type="checkbox" checked> Include Uppercase</label>
      <label><input id="incNums" type="checkbox" checked> Include Numbers</label>
      <label><input id="incSyms" type="checkbox" checked> Include Symbols</label>
      <button id="genPass">Generate Password</button>
      <div id="passResult" class="result"></div>
      <div class="strength"><div id="strengthBar" class="strength-bar"></div></div>
      <button id="checkPwned">Check if Pwned</button>
      <div id="pwnedResult" class="result"></div>
    </div>

    <!-- Subdomain Finder -->
    <div id="subdomains" class="tool hidden">
      <label for="domainInput">Enter domain:</label>
      <input id="domainInput" type="text" placeholder="example.com">
      <button id="findSubs">Find Subdomains</button>
      <div id="subsResult" class="result"></div>
    </div>

    <button id="exportBtn">Export Results</button>
  </main>
  <footer>&copy; 2025 Cyber Tools | Free Security Toolkit</footer>

  <script>
    // Elements
    const toolSelect = document.getElementById('toolSelect');
    const tools = document.querySelectorAll('.tool');
    const hashInput = document.getElementById('hashInput');
    const hashResult = document.getElementById('hashResult');
    const detectHash = document.getElementById('detectHash');
    const passLen = document.getElementById('passLen');
    const lenDisplay = document.getElementById('lenDisplay');
    const incUpper = document.getElementById('incUpper');
    const incNums = document.getElementById('incNums');
    const incSyms = document.getElementById('incSyms');
    const genPass = document.getElementById('genPass');
    const passResult = document.getElementById('passResult');
    const strengthBar = document.getElementById('strengthBar');
    const checkPwned = document.getElementById('checkPwned');
    const pwnedResult = document.getElementById('pwnedResult');
    const domainInput = document.getElementById('domainInput');
    const findSubs = document.getElementById('findSubs');
    const subsResult = document.getElementById('subsResult');
    const exportBtn = document.getElementById('exportBtn');

    let generatedPassword = "";

    // Hash patterns
    const hashPatterns = [
      { regex:/^[a-f0-9]{32}$/i, name:"MD5", desc:"Fast, insecure" },
      { regex:/^[a-f0-9]{40}$/i, name:"SHA-1", desc:"Broken, avoid" },
      { regex:/^[a-f0-9]{64}$/i, name:"SHA-256", desc:"Strong, widely used" },
      { regex:/^[a-f0-9]{128}$/i, name:"SHA-512", desc:"Strong, widely used" },
      { regex:/^\$2[aby]\$.{56}$/, name:"bcrypt", desc:"Modern secure hash" },
      { regex:/^\$argon2(?:id|i|d)\$.+/i, name:"Argon2", desc:"Modern secure hash" }
    ];

    // Switch tools
    function switchTool(tool) {
      tools.forEach(t => t.classList.add('hidden'));
      document.getElementById(tool).classList.remove('hidden');
    }
    toolSelect.addEventListener('change', () => switchTool(toolSelect.value));

    // Hash detector
    detectHash.addEventListener('click', () => {
      const input = hashInput.value.trim();
      let match = hashPatterns.find(p => p.regex.test(input));
      hashResult.textContent = match ? `Looks like: ${match.name} ‚Äì ${match.desc}` : "Unknown hash type.";
    });

    // Password generator
    passLen.addEventListener('input', () => lenDisplay.textContent = passLen.value);
    genPass.addEventListener('click', () => {
      const len = +passLen.value;
      let chars = "abcdefghijklmnopqrstuvwxyz";
      if (incUpper.checked) chars += "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      if (incNums.checked) chars += "0123456789";
      if (incSyms.checked) chars += "!@#$%^&*()_-+=<>?";
      let pwd = "";
      for (let i=0;i<len;i++) pwd += chars[Math.floor(Math.random()*chars.length)];
      generatedPassword = pwd;
      passResult.textContent = "Generated: " + pwd;
      const strength = Math.min(100,(len/32*100)+(incUpper.checked+incNums.checked+incSyms.checked)*10);
      strengthBar.style.width = strength + "%";
      strengthBar.style.background = strength>70?"green":strength>40?"orange":"red";
    });

    // SHA-1 for HIBP
    async function sha1(msg) {
      const buf = await crypto.subtle.digest("SHA-1", new TextEncoder().encode(msg));
      return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,"0")).join("");
    }

    // Check if password pwned
    checkPwned.addEventListener('click', async () => {
      if (!generatedPassword) return alert("Generate a password first");
      const hash = (await sha1(generatedPassword)).toUpperCase();
      const prefix = hash.slice(0,5), suffix = hash.slice(5);
      try {
        const res = await fetch(`/api/pwned-range/${prefix}`);
        const text = await res.text();
        const lines = text.split("\n").map(l=>l.trim()).filter(Boolean);
        const found = lines.find(l => l.split(":")[0] === suffix);
        if (found) {
          const count = found.split(":")[1];
          pwnedResult.textContent = `‚ö†Ô∏è Found in ${count} breaches! Do not use.`;
        } else {
          pwnedResult.textContent = "‚úÖ Not found in known breaches.";
        }
      } catch(e) {
        pwnedResult.textContent = "Error checking breach database.";
      }
    });

    // Subdomain finder
    findSubs.addEventListener('click', async () => {
      const domain = domainInput.value.trim();
      if (!domain) return;
      subsResult.textContent = "Searching...";
      try {
        const res = await fetch(`/api/subdomains?domain=${encodeURIComponent(domain)}`);
        const arr = await res.json();
        subsResult.textContent = arr.length ? arr.join(", ") : "No subdomains found.";
      } catch(e) {
        subsResult.textContent = "Error fetching subdomains.";
      }
    });

    // Export results
    exportBtn.addEventListener('click', () => {
      let content = "";
      if (hashResult.textContent) content += "Hash Result: " + hashResult.textContent + "\n";
      if (generatedPassword) {
        const include = confirm("Include password in export file?");
        content += include? "Password: "+generatedPassword+"\n":"Password: [REDACTED]\n";
        content += "Strength: "+strengthBar.style.width+"\n";
      }
      if (pwnedResult.textContent) content += "Pwned Check: "+pwnedResult.textContent+"\n";
      if (subsResult.textContent) content += "Subdomains:\n"+subsResult.textContent+"\n";
      const blob = new Blob([content], {type:"text/plain"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "cybertools.txt";
      a.click();
    });

    // Init
    lenDisplay.textContent = passLen.value;
    switchTool(toolSelect.value);
  </script>
</body>
</html>
